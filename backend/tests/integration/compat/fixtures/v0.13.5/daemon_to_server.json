{
  "version": "0.13.5",
  "exchanges": [
    {
      "method": "POST",
      "path": "/api/daemons/19a9f824-dc42-4bbd-8a1c-208bff30e60f/startup",
      "request_body": {
        "daemon_version": "0.13.5"
      },
      "response_status": 404,
      "response_body": {
        "error": "Daemon '19a9f824-dc42-4bbd-8a1c-208bff30e60f' not found",
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": false
      }
    },
    {
      "method": "POST",
      "path": "/api/daemons/register",
      "request_body": {
        "capabilities": {
          "has_docker_socket": false,
          "interfaced_subnet_ids": []
        },
        "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
        "mode": "Push",
        "name": "scanopy-daemon",
        "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
        "url": "http://172.25.0.4:60073",
        "user_id": "00000000-0000-0000-0000-000000000000",
        "version": "0.13.5"
      },
      "response_status": 200,
      "response_body": {
        "data": {
          "daemon": {
            "capabilities": {
              "has_docker_socket": false,
              "interfaced_subnet_ids": []
            },
            "created_at": "2026-01-23T03:40:38.906367587Z",
            "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
            "id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
            "last_seen": "2026-01-23T03:40:38.906367087Z",
            "mode": "Push",
            "name": "scanopy-daemon",
            "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
            "tags": [],
            "updated_at": "2026-01-23T03:40:38.906367587Z",
            "url": "http://172.25.0.4:60073",
            "user_id": "506f2da2-7e83-446b-a8c0-e7bb5f77e9cd",
            "version": "0.13.5"
          },
          "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
          "server_capabilities": {
            "minimum_daemon_version": "0.12.0",
            "server_version": "0.13.5"
          }
        },
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/v1/subnets",
      "request_body": {
        "cidr": "172.25.0.0/28",
        "created_at": "2026-01-23T03:40:38.922055170Z",
        "description": null,
        "id": "1e60303a-5ca5-42c5-b394-6dc86bf1c5c5",
        "name": "172.25.0.0/28",
        "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
        "source": {
          "metadata": [
            {
              "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
              "date": "2026-01-23T03:40:38.922050087Z",
              "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
              "type": "SelfReport"
            }
          ],
          "type": "Discovery"
        },
        "subnet_type": "Lan",
        "tags": [],
        "updated_at": "2026-01-23T03:40:38.922055170Z"
      },
      "response_status": 200,
      "response_body": {
        "data": {
          "cidr": "172.25.0.0/28",
          "created_at": "2026-01-23T03:40:38.922055170Z",
          "description": null,
          "id": "1e60303a-5ca5-42c5-b394-6dc86bf1c5c5",
          "name": "172.25.0.0/28",
          "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
          "source": {
            "metadata": [
              {
                "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
                "date": "2026-01-23T03:40:38.922050087Z",
                "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
                "type": "SelfReport"
              }
            ],
            "type": "Discovery"
          },
          "subnet_type": "Lan",
          "tags": [],
          "updated_at": "2026-01-23T03:40:38.922055170Z"
        },
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/daemons/19a9f824-dc42-4bbd-8a1c-208bff30e60f/update-capabilities",
      "request_body": {
        "has_docker_socket": false,
        "interfaced_subnet_ids": [
          "1e60303a-5ca5-42c5-b394-6dc86bf1c5c5"
        ]
      },
      "response_status": 200,
      "response_body": {
        "data": null,
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/v1/hosts/discovery",
      "request_body": {
        "host": {
          "created_at": "2026-01-23T03:40:38.942039920Z",
          "description": "Scanopy daemon",
          "hidden": false,
          "hostname": "fb8f9954ad51",
          "id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
          "name": "fb8f9954ad51",
          "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
          "source": {
            "metadata": [
              {
                "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
                "date": "2026-01-23T03:40:38.942038962Z",
                "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
                "type": "SelfReport"
              }
            ],
            "type": "Discovery"
          },
          "tags": [],
          "updated_at": "2026-01-23T03:40:38.942039920Z",
          "virtualization": null
        },
        "interfaces": [
          {
            "created_at": "2026-01-23T03:40:38.922189628Z",
            "host_id": "00000000-0000-0000-0000-000000000000",
            "id": "3de219f0-edbe-40f4-9ad4-8653bcefa0b3",
            "ip_address": "172.25.0.4",
            "mac_address": "5A:46:49:37:08:46",
            "name": "eth0",
            "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
            "position": 0,
            "subnet_id": "1e60303a-5ca5-42c5-b394-6dc86bf1c5c5",
            "updated_at": "2026-01-23T03:40:38.922189628Z"
          }
        ],
        "ports": [
          {
            "created_at": "2026-01-23T03:40:38.941880962Z",
            "host_id": "00000000-0000-0000-0000-000000000000",
            "id": "c7f5ee8c-2f89-41cf-b4bc-aecc3a4271be",
            "network_id": "00000000-0000-0000-0000-000000000000",
            "number": 60073,
            "protocol": "Tcp",
            "type": "Custom",
            "updated_at": "2026-01-23T03:40:38.941880962Z"
          }
        ],
        "services": [
          {
            "bindings": [
              {
                "created_at": "2026-01-23T03:40:38.942047670Z",
                "id": "e5af9386-ec72-4a91-8bc8-943aa089fec8",
                "interface_id": "3de219f0-edbe-40f4-9ad4-8653bcefa0b3",
                "network_id": "00000000-0000-0000-0000-000000000000",
                "port_id": "c7f5ee8c-2f89-41cf-b4bc-aecc3a4271be",
                "service_id": "00000000-0000-0000-0000-000000000000",
                "type": "Port",
                "updated_at": "2026-01-23T03:40:38.942047670Z"
              }
            ],
            "created_at": "2026-01-23T03:40:38.942053462Z",
            "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
            "id": "9656c9f1-6b0a-4420-aea4-688c0d02960e",
            "name": "Scanopy Daemon",
            "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
            "position": 0,
            "service_definition": "Scanopy Daemon",
            "source": {
              "details": {
                "confidence": "Certain",
                "reason": {
                  "data": "Scanopy Daemon self-report",
                  "type": "reason"
                }
              },
              "metadata": [
                {
                  "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
                  "date": "2026-01-23T03:40:38.942048753Z",
                  "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
                  "type": "SelfReport"
                }
              ],
              "type": "DiscoveryWithMatch"
            },
            "tags": [],
            "updated_at": "2026-01-23T03:40:38.942053462Z",
            "virtualization": null
          }
        ]
      },
      "response_status": 200,
      "response_body": {
        "data": {
          "created_at": "2026-01-23T03:40:38.902634Z",
          "description": null,
          "hidden": false,
          "hostname": "fb8f9954ad51",
          "id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
          "interfaces": [
            {
              "created_at": "2026-01-23T03:40:38.922189628Z",
              "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
              "id": "3de219f0-edbe-40f4-9ad4-8653bcefa0b3",
              "ip_address": "172.25.0.4",
              "mac_address": "5A:46:49:37:08:46",
              "name": "eth0",
              "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
              "position": 0,
              "subnet_id": "1e60303a-5ca5-42c5-b394-6dc86bf1c5c5",
              "updated_at": "2026-01-23T03:40:38.922189628Z"
            }
          ],
          "name": "scanopy-daemon",
          "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
          "ports": [
            {
              "created_at": "2026-01-23T03:40:38.941880962Z",
              "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
              "id": "c7f5ee8c-2f89-41cf-b4bc-aecc3a4271be",
              "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
              "number": 60073,
              "protocol": "Tcp",
              "type": "Custom",
              "updated_at": "2026-01-23T03:40:38.941880962Z"
            }
          ],
          "services": [
            {
              "bindings": [
                {
                  "created_at": "2026-01-23T03:40:38.942047670Z",
                  "id": "e5af9386-ec72-4a91-8bc8-943aa089fec8",
                  "interface_id": "3de219f0-edbe-40f4-9ad4-8653bcefa0b3",
                  "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
                  "port_id": "c7f5ee8c-2f89-41cf-b4bc-aecc3a4271be",
                  "service_id": "9656c9f1-6b0a-4420-aea4-688c0d02960e",
                  "type": "Port",
                  "updated_at": "2026-01-23T03:40:38.942047670Z"
                }
              ],
              "created_at": "2026-01-23T03:40:38.942053462Z",
              "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
              "id": "9656c9f1-6b0a-4420-aea4-688c0d02960e",
              "name": "Scanopy Daemon",
              "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
              "position": 0,
              "service_definition": "Scanopy Daemon",
              "source": {
                "details": {
                  "confidence": "Certain",
                  "reason": {
                    "data": "Scanopy Daemon self-report",
                    "type": "reason"
                  }
                },
                "metadata": [
                  {
                    "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
                    "date": "2026-01-23T03:40:38.942048753Z",
                    "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
                    "type": "SelfReport"
                  }
                ],
                "type": "DiscoveryWithMatch"
              },
              "tags": [],
              "updated_at": "2026-01-23T03:40:38.942053462Z",
              "virtualization": null
            }
          ],
          "source": {
            "metadata": [
              {
                "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
                "date": "2026-01-23T03:40:38.942038962Z",
                "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
                "type": "SelfReport"
              }
            ],
            "type": "Discovery"
          },
          "tags": [],
          "updated_at": "2026-01-23T03:40:38.902634Z",
          "virtualization": null
        },
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/v1/discovery/6845dcc8-6ea0-47af-9ce3-054b8cf1f667/update",
      "request_body": {
        "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
        "discovery_type": {
          "host_id": "1438e666-92b6-4fad-bc37-aa2717d9ba42",
          "type": "SelfReport"
        },
        "error": null,
        "finished_at": "2026-01-23T03:40:38.980206587Z",
        "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
        "phase": "Complete",
        "progress": 100,
        "session_id": "6845dcc8-6ea0-47af-9ce3-054b8cf1f667",
        "started_at": "2026-01-23T03:40:38.920476295Z"
      },
      "response_status": 200,
      "response_body": {
        "data": null,
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/v1/discovery/d53d5b11-b914-4af1-bf04-5d6e47899de1/update",
      "request_body": {
        "daemon_id": "19a9f824-dc42-4bbd-8a1c-208bff30e60f",
        "discovery_type": {
          "host_naming_fallback": "BestService",
          "subnet_ids": null,
          "type": "Network"
        },
        "error": null,
        "finished_at": null,
        "network_id": "abc621e2-58e7-44bb-a87b-db84a22afedd",
        "phase": "Started",
        "progress": 0,
        "session_id": "d53d5b11-b914-4af1-bf04-5d6e47899de1",
        "started_at": "2026-01-23T03:40:39.007214962Z"
      },
      "response_status": 200,
      "response_body": {
        "data": null,
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/daemons/19a9f824-dc42-4bbd-8a1c-208bff30e60f/heartbeat",
      "request_body": {
        "mode": "Push",
        "name": "scanopy-daemon",
        "url": "http://172.25.0.4:60073"
      },
      "response_status": 200,
      "response_body": {
        "data": null,
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": true
      }
    },
    {
      "method": "POST",
      "path": "/api/v1/discovery/a778d8ff-2cee-486d-bffe-7f57db840d25/update",
      "request_body": {
        "daemon_id": "62e4f43e-f52b-4dd0-9a8d-cf82a9dfbc06",
        "discovery_type": {
          "host_naming_fallback": "Ip",
          "snmp_credentials": {
            "default_credential": null,
            "ip_overrides": []
          },
          "subnet_ids": [
            "4a025354-1915-4ba8-ba15-3459c06e5178"
          ],
          "type": "Network"
        },
        "error": null,
        "finished_at": null,
        "network_id": "b0000000-0000-0000-0000-000000000001",
        "phase": "Scanning",
        "progress": 73,
        "session_id": "a778d8ff-2cee-486d-bffe-7f57db840d25",
        "started_at": "2026-01-23T03:05:47.367454Z"
      },
      "response_status": 401,
      "response_body": {
        "error": "Invalid API key",
        "meta": {
          "api_version": 1,
          "server_version": "0.13.5"
        },
        "success": false
      }
    }
  ]
}